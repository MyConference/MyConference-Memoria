\chapter{Web}
\label{chap:web}

La Web es la encargada de la gestión de los congresos de MyConference. Desde la aplicación Web se crean los nuevos congresos y se añade toda la información correspondiente a estos. Aunque también se pueden visualizar los datos creados desde la Web, su función principal es la creación y borrado de datos de los congresos.

\section{Uso}
\label{sec:web-use}

La Web está basada sobre \textit{Express}, framework de desarrollo de aplicaciones web de \nameref{tech:nodejs}.

Como se ha dicho antes, la función principal de la Web es la creación y el borrado de datos, además de la visualización de estos datos. Para poder realizar estas operaciones es necesario establecer conexiones con la API mediante llamadas HTTP.

\section{Estructura}
\label{sec:web-structure}

La aplicación Web se divide en tres partes: archivos de configuración, rutas y diseño.

\subsection{Archivos de configuración}

Los \textit{archivos de configuración} de la aplicación web se encargan de:
\begin{itemize}
    \item Configurar el módulo \textit{winston} para usar logs en la aplicación.
    \item Configurar las sesiones de la aplicación.
    \item Configurar el módulo \textit{node-sass} para que compile los archivos de \nameref{tech:sass} a CSS.
    \item Establecer como archivos estáticos los archivos de la carpeta \textit{public}.
    \item Establecer \nameref{tech:jade} como motor para las vistas.
    \item Comprobar si los tokens de refresco han caducado.
    \item Enlazar las rutas de la aplicación, explicadas en la sección \ref{subsec:web-routes}
    \item Configurar el puerto en el que escucha la aplicación.
    \item Configurar el entorno de desarrollo, que puede ser producción o desarrollo.
    \item Configurar la base de datos MongoDB en función del entorno de desarrollo.
    \item Establecer la URL de la API en función del entorno de desarrollo.
    \item Configurar el módulo \textit{restify}.
\end{itemize}

\subsection{Rutas}
\label{subsec:web-routes}

La carpeta \textit{routes} es la que contiene todos los archivos con las llamadas HTTP a la API. Las llamadas están organizadas en diferentes archivos según los datos que se requieran. Todos los archivos están enlazados desde los archivos de configuración.

\subsection{Diseño}

Todos los elementos de diseño se guardan en la carpeta \textit{public}. En esta carpeta se encuentran los archivos de CSS y JavaScript que requiere la aplicación.

El estilo de la aplicación es muy básico y viene dado en su gran mayoría por librerías externas.

\begin{itemize}
    \item \nameref{tech:bootstrap}: prácticamente todo el estilo de la página se ha podido hacer de manera fácil y rápida gracias a este framework, obteniendo un resultado sencillo y vistoso añadiendo unas pocas líneas de código.
    \item \nameref{tech:googlemaps}: usada para el mapa que permite visualizar los lugares añadidos para un congreso.
\end{itemize}

Fuera de la carpeta \textit{public} está la carpeta \textit{Sass}, que contiene todos los archivos .scss que usamos en la aplicación. Esta carpeta está fuera de la carpeta \textit{public}
ya que realmente la aplicación no usa estos archivos para el diseño, solo los compila y los traduce a archivos CSS que se guardan dentro de la carpeta \textit{public}. Estos archivos CSS son los que se usan realmente en la aplicación.

\section{Casos de uso}

\subsection{Caso de uso: registro de usuario}

\begin{enumerate}
    \item \textbf{Objetivo}

        Registrar al usuario en la aplicación.
    \item \textbf{Actores}

        Usuario sin registrar.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y está en página de registro.
    \item \textbf{Postcondición si éxito}

        El usuario  queda registrado.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando el fallo que ha ocurrido.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos obligatorios:
    	\begin{itemize}
    		\item E-mail.
    		\item Contraseña.
    		\item Repetir contraseña.
    	\end{itemize}
    \item \textbf{Salidas}

        Acceso a la aplicación o mensaje de error en caso de fallo.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Comprobar que no haya ningún campo vacío. Si hay algún campo vacío, S-1.
        	\item Comprobar que sea un e-mail válido. Si no es un e-mail válido, S-2.
        	\item Comprobar que la contraseña tenga 8 caracteres mínimo. Si la contraseña es demasiado corta, S-3.
        	\item Comprobar que los campos contraseña y repetir contraseña sean iguales. Si no coinciden, S-4.
        	\item Comprobar que el e-mail no ha sido registrado previamente en la aplicación. Si ha sido registrado previamente, S-5.
        	\item El usuario es registrado en la aplicación y se inicia sesión automáticamente.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error indicando los campos faltantes.
        	\item S-2. Se muestra un mensaje de error indicando que el e-mail no tiene un formato válido.
        	\item S-3. Se muestra un mensaje de error indicando que la contraseña es demasiado corta.
        	\item S-4. Se muestra un mensaje de error indicando que los campos contraseña y repetir contraseña tienen que coincidir.
        	\item S-5. Se muestra un mensaje de error indicando que el e-mail ya está registrado.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: inicio de sesión}

\begin{enumerate}
    \item \textbf{Objetivo}

        Identificar al usuario mediante sus credenciales para el acceso a la aplicación.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

    	El usuario ha accedido a la web y se ha registrado previamente.
    \item \textbf{Postcondición si éxito}

        Se identifica al usuario y accede a sus datos en la aplicación.
    \item \textbf{Postcondición si fallo}

        Se muestra mensaje de error indicando el fallo que ha ocurrido.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos obligatorios:
    	\begin{itemize}
    		\item E-mail.
    		\item Contraseña.
    	\end{itemize}
    \item \textbf{Salidas}

        Acceso a la sesión del usuario o mensaje de error en caso de fallo.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
            \item Comprobar que no haya ningún campo vacío. Si hay algún campo vacío, S-1.
        	\item Comprobar que sea un e-mail válido. Si no es un e-mail válido, S-2.
        	\item Comprobar que la contraseña tenga 8 caracteres mínimo. Si la contraseña es demasiado corta, S-3.
        	\item Comprobar que el e-mail está registrado en la aplicación. Si no ha sido registrado previamente, S-4.
        	\item El usuario inicia sesión.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}

        \begin{itemize}
        	\item S-1. Se muestra un mensaje de error indicando los campos faltantes.
        	\item S-2. Se muestra un mensaje de error indicando que el e-mail no tiene un formato válido.
        	\item S-3. Se muestra un mensaje de error indicando que la contraseña es demasiado corta.
        	\item S-4. Se muestra un mensaje de error indicando que el e-mail no está registrado en la aplicación.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: mostrar los datos del usuario}

\begin{enumerate}
    \item \textbf{Objetivo}

        Mostrar al usuario sus datos mediante llamadas a la API. Estos datos pueden ser:
        \begin{itemize}
        	\item Lista de congresos, tanto los creados por el propio usuario como a los que ha sido invitado a asistir.
        	\item Lista de los usuarios invitados al congreso.
        	\item Lista de los anuncios del congreso.
        	\item Lista de los documentos del congreso.
        	\item Lista de lugares del congreso.
        	\item Lista de los organizadores del congreso.
        	\item Lista de los ponentes del congreso.
        	\item Lista de los eventos de la agenda del congreso.
        \end{itemize}
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha iniciado sesión con su cuenta y se han recibido correctamente los datos de la API.
    \item \textbf{Postcondición si éxito}

        Se muestra una lista con los datos según la sección en la que esté el usuario.
    \item \textbf{Postcondición si fallo}

        Se muestra mensaje de error indicando que no se han recibido correctamente los datos.
    \item \textbf{Entradas}

        Ninguna.
    \item \textbf{Salidas}

        Lista con los datos correspondientes.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
            \item Se hace una llamada a la API pidiendo los datos correspondientes. Si no se puede realizar la llamada error, S-1.
            \item Se muestra la lista con los datos.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}

    	\begin{itemize}
        	\item S-1. Se muestra mensaje de error indicando que no se han recibido correctamente los datos.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: creación de congresos}

\begin{enumerate}
    \item \textbf{Objetivo}

        Crear un nuevo congreso.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se crea un nuevo congreso.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido crear el congreso.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Nombre del congreso.
			\item Descripción del congreso.
    	\end{itemize}
    \item \textbf{Salidas}

        El nuevo congreso.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se crea el congreso.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: invitación de usuarios}

\begin{enumerate}
    \item \textbf{Objetivo}

        Invitar a usuarios al congreso para que puedan visualizar sus datos.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se manda al otro usuario un correo con la invitación.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido mandar la invitación.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Nombre del usuario al que se quiere invitar.
			\item E-mail del usuario al que se quiere invitar.
    	\end{itemize}
    \item \textbf{Salidas}

        Correo con un código de activación.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se manda la invitación.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: activación de congresos}

\begin{enumerate}
    \item \textbf{Objetivo}

        Activar el congreso al que el usuario ha sido invitado.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se añade la información del congreso a la cuenta del usuario.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido activar el congreso.
    \item \textbf{Entradas}

    	Código de activación.
    \item \textbf{Salidas}

        Datos del congreso.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Abrir el enlace que se proporciona en el correo.
        	\item Introducir el código de activación en el enlace abierto previamente.
        	\item Se valida el código de activación. Si falla, S-1.
        	\item Se añade la información del congreso en la cuenta del usuario.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que el código de activación no es válido.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: creación de anuncios}

\begin{enumerate}
    \item \textbf{Objetivo}

        Crear un nuevo anuncio.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se crea un nuevo anuncio.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido crear el anuncio.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Título del anuncio.
			\item Cuerpo del anuncio.
    	\end{itemize}
    \item \textbf{Salidas}

        El nuevo anuncio.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se crea el anuncio.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: creación de lugares}

\begin{enumerate}
    \item \textbf{Objetivo}

        Crear un nuevo lugar.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se crea un nuevo lugar.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido crear el lugar.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Nombre del lugar.
			\item Detalles del lugar.
			\item Coordenadas geográficas o dirección del lugar.
    	\end{itemize}
    \item \textbf{Salidas}

        El nuevo lugar.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se crea el lugar.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: creación de organizadores}

\begin{enumerate}
    \item \textbf{Objetivo}

        Crear un nuevo organizador.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se crea un nuevo organizador.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido crear el organizador.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Nombre del organizador.
			\item Procedencia del organizador.
			\item Detalles del organizador.
			\item Grupo del organizador.
    	\end{itemize}
    \item \textbf{Salidas}

        El nuevo organizador.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se crea el organizador.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: creación de ponentes}

\begin{enumerate}
    \item \textbf{Objetivo}

        Crear un nuevo ponente.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se crea un nuevo ponente.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido crear el ponente.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Nombre del ponente.
			\item Procedencia del ponente.
			\item Cargo del ponente.
			\item Descripción del ponente.
    	\end{itemize}
    \item \textbf{Salidas}

        El nuevo ponente.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se crea el ponente.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: creación de eventos de la agenda}

\begin{enumerate}
    \item \textbf{Objetivo}

        Crear un nuevo evento en la agenda.
    \item \textbf{Actores}

        Usuario registrado en la aplicación.
    \item \textbf{Precondición}

        El usuario ha accedido a la web y ha iniciado sesión.
    \item \textbf{Postcondición si éxito}

        Se crea un nuevo evento en la agenda.
    \item \textbf{Postcondición si fallo}

        Se muestra un mensaje de error indicando que no se ha podido crear el evento.
    \item \textbf{Entradas}

    	Formulario con los siguientes campos:
    	\begin{itemize}
    		\item Título del evento.
			\item Descripción del evento.
			\item Día, mes y año del evento.
			\item Hora y minutos del evento.
    	\end{itemize}
    \item \textbf{Salidas}

        El nuevo evento.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
        	\item Rellenar los campos del formulario.
        	\item Comprobar que los campos tienen el formato correcto. Si algún campo no tiene el formato correcto, S-1.
        	\item Se crea el evento de la agenda.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}
    	\begin{itemize}
        	\item S-1. Se muestra un mensaje de error informando que algún campo tiene un formato incorrecto.
        \end{itemize}
\end{enumerate}

\newpage

\subsection{Caso de uso: borrado de datos}

\begin{enumerate}
    \item \textbf{Objetivo}

        El usuario elimina datos de su cuenta. Los datos que puede borrar son:
        \begin{itemize}
        	\item Congresos.
        	\item Anuncios.
        	\item Documentos.
        	\item Lugares.
        	\item Organizadores.
        	\item Ponentes.
        	\item Eventos de la agenda.
        \end{itemize}
    \item \textbf{Actores}

        Usuario registrado.
    \item \textbf{Precondición}

        El usuario es el propietario de los datos que se quieren borrar.
    \item \textbf{Postcondición si éxito}

        Se eliminan los datos.
    \item \textbf{Postcondición si fallo}

        Se muestra mensaje de error informando del fallo.
    \item \textbf{Entradas}

        Ninguna.
    \item \textbf{Salidas}

        Se elimina el dato.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
            \item El usuario pulsa sobre el botón \textbf{Delete} en el dato que quiere eliminar. Si no se ha podido eliminar, S-1.
            \item Se elimina el dato.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}

		\begin{enumerate}
            \item S-1. se muestra mensaje de error informando del fallo.
        \end{enumerate}
\end{enumerate}

\newpage

\subsection{Caso de uso: cerrar sesión}

\begin{enumerate}
    \item \textbf{Objetivo}

        Cerrar la sesión actual del usuario y volver a la página inicial de la web.
    \item \textbf{Actores}

        Usuario registrado.
    \item \textbf{Precondición}

        El usuario ha iniciado sesión en la aplicación.
    \item \textbf{Postcondición si éxito}

        Se cierra la sesión actual del usuario.
    \item \textbf{Postcondición si fallo}

        Ninguna.
    \item \textbf{Entradas}

        Ninguna.
    \item \textbf{Salidas}

        Cierre de la sesión actual del usuario.
    \item \textbf{Secuencia normal}

        \begin{enumerate}
            \item El usuario pulsa sobre el botón \textbf{Log out} en la barra de navegación.
            \item Se cierra la sesión.
        \end{enumerate}
    \item \textbf{Secuencia alternativa}

        Ninguna.
\end{enumerate}
